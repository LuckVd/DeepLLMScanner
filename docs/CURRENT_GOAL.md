# å½“å‰ç›®æ ‡

> å•ä¸€ç„¦ç‚¹ï¼šæœ¬æ¬¡ä¼šè¯å…³æ³¨çš„æ ¸å¿ƒä»»åŠ¡

---

## ç›®æ ‡ä¿¡æ¯

| å­—æ®µ | å€¼ |
|------|-----|
| **ä»»åŠ¡** | ä¼˜åŒ–æ£€æµ‹å™¨ï¼šæ”¹è¿›æ­£åˆ™ç²¾ç¡®åº¦ + æ·»åŠ  LLM è£å†³ |
| **çŠ¶æ€** | completed |
| **ä¼˜å…ˆçº§** | high |
| **åˆ›å»ºæ—¥æœŸ** | 2026-02-19 |

---

## å®Œæˆæ ‡å‡†

- [x] æ”¹è¿› PII æ£€æµ‹æ­£åˆ™è¡¨è¾¾å¼ï¼Œå‡å°‘è¯¯æŠ¥
- [x] æ”¹è¿›æ•æ„Ÿå†…å®¹æ£€æµ‹è§„åˆ™
- [x] æ”¹è¿› System Prompt æ£€æµ‹è§„åˆ™
- [x] æ·»åŠ ç½®ä¿¡åº¦é˜ˆå€¼é…ç½®
- [x] å®ç° LLM è£å†³æ¨¡å—ï¼ˆä½¿ç”¨æœ¬åœ°æ¨¡å‹ï¼‰
- [x] åœ¨æ’ä»¶ä¸­é›†æˆ LLM è£å†³äºŒæ¬¡ç¡®è®¤
- [x] æµ‹è¯•æ”¹è¿›åçš„æ£€æµ‹æ•ˆæœ

---

## å…³è”æ¨¡å—

- `src/plugins/LLM02_data_leak/plugin.py` - æ•°æ®æ³„éœ²æ£€æµ‹
- `src/plugins/LLM07_system_prompt_leak/plugin.py` - ç³»ç»Ÿæç¤ºæ³„éœ²æ£€æµ‹
- `src/core/detection_engine/` - LLM è£å†³æ¨¡å—ï¼ˆæ–°å»ºï¼‰

---

## ä»»åŠ¡æ¸…å•

| åºå· | ä»»åŠ¡ | äº§å‡º | çŠ¶æ€ |
|------|------|------|------|
| 1 | æ”¹è¿› PII æ­£åˆ™è¡¨è¾¾å¼ | `LLM02/plugin.py` | completed |
| 2 | æ”¹è¿›æ•æ„Ÿå†…å®¹æ£€æµ‹è§„åˆ™ | `LLM02/plugin.py` | completed |
| 3 | æ”¹è¿› System Prompt æ£€æµ‹è§„åˆ™ | `LLM07/plugin.py` | completed |
| 4 | æ·»åŠ ç½®ä¿¡åº¦é˜ˆå€¼é…ç½® | `base.py` | completed |
| 5 | åˆ›å»º LLM è£å†³æ¨¡å— | `detection_engine/llm_judge.py` | completed |
| 6 | é›†æˆ LLM è£å†³åˆ°æ’ä»¶ | æ›´æ–°å„ plugin | completed |
| 7 | æµ‹è¯•æ”¹è¿›æ•ˆæœ | æ‰‹åŠ¨æµ‹è¯• | completed |

---

## è¿›åº¦è®°å½•

| æ—¶é—´ | è¿›å±• |
|------|------|
| 2026-02-19 | ğŸ¯ ç›®æ ‡è®¾ç½®ï¼šä¼˜åŒ–æ£€æµ‹å™¨ |
| 2026-02-19 | ğŸ“ æ”¹è¿› LLM02 æ’ä»¶ - æ›´ç²¾ç¡®çš„ PII æ­£åˆ™ã€æ’é™¤æ¨¡å¼ã€ç½®ä¿¡åº¦é˜ˆå€¼ |
| 2026-02-19 | ğŸ“ æ”¹è¿› LLM07 æ’ä»¶ - åˆ†å±‚ç½®ä¿¡åº¦æ¨¡å¼ã€æ’é™¤æ¨¡å¼ |
| 2026-02-19 | ğŸ”§ æ›´æ–° base.py - æ·»åŠ  confidence_threshold å’Œ use_llm_judge é…ç½® |
| 2026-02-19 | ğŸ“¦ åˆ›å»º detection_engine/llm_judge.py - LLM è£å†³æ¨¡å— |
| 2026-02-19 | âœ… 53 ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡ |
| 2026-02-19 | ğŸ§ª å®é™…æµ‹è¯• DeepSeek API - è¯¯æŠ¥ä» 6 ä¸ªå‡å°‘åˆ° 1 ä¸ª (83% æ”¹è¿›) |
| 2026-02-19 | âœ… ç›®æ ‡å®Œæˆ |

---

## äº§å‡ºæ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `src/plugins/LLM02_data_leak/plugin.py` | æ”¹è¿›çš„æ£€æµ‹è§„åˆ™ |
| `src/plugins/LLM07_system_prompt_leak/plugin.py` | æ”¹è¿›çš„æ£€æµ‹è§„åˆ™ |
| `src/core/detection_engine/__init__.py` | æ¨¡å—å¯¼å‡º |
| `src/core/detection_engine/llm_judge.py` | LLM è£å†³æ¨¡å— |

---

## å¤‡æ³¨

### é—®é¢˜åˆ†æ

å½“å‰æ£€æµ‹å™¨å­˜åœ¨çš„é—®é¢˜ï¼š
1. **Phone æ­£åˆ™è¿‡äºå®½æ³›**ï¼š`\d{10}` ä¼šåŒ¹é…æ—¶é—´æˆ³ã€ID ç­‰
2. **æ•æ„Ÿå†…å®¹å…³é”®è¯å¤ªæ³›**ï¼š`internal`ã€`private` æ˜¯å¸¸è§è¯
3. **System Prompt æ¨¡å¼å¤ªå®½æ¾**ï¼š`do not`ã€`always` æ˜¯å¸¸è§è‹±è¯­è¡¨è¾¾
4. **æ— äºŒæ¬¡ç¡®è®¤æœºåˆ¶**ï¼šä¸€æ—¦åŒ¹é…å°±æŠ¥å‘Šï¼Œæ²¡æœ‰è¯­ä¹‰ç†è§£

### æ”¹è¿›æ–¹æ¡ˆ

#### 1. æ­£åˆ™æ”¹è¿›

```python
# æ”¹è¿›å‰
"phone": r"\b\d{10}\b"  # åŒ¹é…ä»»ä½•10ä½æ•°å­—

# æ”¹è¿›å
"phone": r"\b(?:\+?1[-.\s]?)?\(?[2-9]\d{2}\)?[-.\s]?\d{3}[-.\s]?\d{4}\b"  # æ›´ç²¾ç¡®çš„ç¾å›½ç”µè¯æ ¼å¼
```

#### 2. LLM è£å†³

```python
class LLMJudge:
    """ä½¿ç”¨æœ¬åœ° LLM å¯¹æ£€æµ‹ç»“æœè¿›è¡Œè¯­ä¹‰åˆ¤æ–­"""

    def judge_detection(self, response: str, evidence: dict) -> tuple[bool, float]:
        """
        Returns:
            (is_real_vulnerability, confidence)
        """
```

### LLM è£å†³æµç¨‹

```
æ­£åˆ™æ£€æµ‹ â†’ å‘ç°æ½œåœ¨æ¼æ´ â†’ LLM è£å†³ â†’ ç¡®è®¤/æ’é™¤
    â†“              â†“              â†“
 confidence=0.9  evidence     è¯­ä¹‰åˆ†æ
                              â†“
                         çœŸæ­£çš„æ¼æ´ï¼Ÿ
                              â†“
                         æ›´æ–° confidence
```
